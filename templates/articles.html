{{if .CurType}}
	{{if .IsReply}}
		<title>文章回复</title>
		<p id="breadcrumbs">文章No.{{.CurTag}}的回复
	{{end}}

	{{if .IsUA}}
		<title>用户文章</title>
		<p id="breadcrumbs">"{{.UA.UserNickName}}"的文章
	{{end}}

	{{if .IsOWA}}
		<title>个人文章管理</title>
		<p id="breadcrumbs">
		{{if .OWA.IsViewingGlobal}}
			全局文章
		{{else}}
			{{if .OWA.IsViewingOther}}
				"{{.OWA.ViewingOtherName}}"的文章
			{{else}}
				文章管理
			{{end}}
		{{end}}
	{{end}}

	{{if .IsTag}}
		<title>{{.CurTag}}</title>
		<p id="breadcrumbs">"{{.CurTag}}"文章
	{{end}}
{{else}}
	<title>全部文章</title>
	<p id="breadcrumbs">全部文章
{{end}}
<script type="text/javascript">
	document.title += " -- " + etc.date.format({{.Nav.Range.End}});
	document.write(' | ' + etc.date.format({{.Nav.Range.Start}}) + 
	' &raquo; ' + etc.date.format({{.Nav.Range.End}}));
</script>
</p>

{{if .IsOWA}}
	{{range $key, $value := .Tags}}
	   <input class="select-tag" type="checkbox" id="check-{{$key}}" name="check-{{$key}}" onclick="updateTag({{$key}})" checked/><label for="check-{{$key}}">{{$value}}</label>
	{{end}}
	<script type="text/javascript">
		var omit = "{{.CurTag}}".split(":");
		omit.shift();
		for (var i in omit) {
			etc.id("check-" + omit[i]).checked = false;
		}

		function updateTag(tagID) {
			var r = new RegExp("\\:" + tagID + "(\\:?)");
			var owa = "{{.CurTag}}"
			var has = r.test("{{.CurTag}}");
			var cto = etc.id("check-" + tagID).checked;

			if (!cto && !has) {
				owa += ":" + tagID;
			} else if (cto && has) {
				owa = owa.replace(r, "$1");
			}

			window.location.href = "/owa/" + owa + "/page/1";
		}

		function reverseTag() {
			var omit = "{{.CurTag}}".split(":");
			var _new = [omit[0]];

			var chks = document.querySelectorAll("input.select-tag");
			for (var i in chks) {
				if (chks[i].checked) _new.push(chks[i].id.replace("check-", ""));
			}

			window.location.href = "/owa/" + _new.join(':') + "/page/1";
		}
	</script>
	<button onclick="reverseTag()">反选</button>
{{end}}

{{if .Announce.Content}}
<div style="border-bottom: dotted 1px grey;">
	{{.Announce.Content}}
	{{if .Announce.ID}}
		<span style="font-size: 75%; border: dotted 1px #666; padding: 1px 5px; background: steelblue; border-bottom: solid 2px #3c72a0;">
			<a href="/article/{{.Announce.ID}}" style="color: white">#{{.Announce.Author}}</a>
		</span>
	{{end}}
</div>
{{end}}

<div class="pager">
	{{if .IsIndexPage}}[ <b>首页</b> ]{{else}}
	[
	<a href="{{.IndexPage}}"> 首页 </a> |
	<a href="{{.Nav.PrevPage}}"> 上一页 </a>
	]
	{{end}}

	{{if .IsLastPage}}
	[ <b>尾页</b> ]
	{{else}}
	[
	<a href="{{.Nav.NextPage}}"> 下一页 </a> |
	<a href="{{.Nav.LastWeekPage}}" >7d</a> |
	<a href="{{.Nav.LastMonthPage}}">30d</a> |
	<a href="{{.Nav.LastYearPage}}" >1y</a> |
	<a href="{{.LastPage}}" >尾页</a>
	]
	{{end}}
</div>

{{if .IsReply}}
	<table class="toa"><tr>
			<td><a href="/new/article/{{.CurTag}}?/reply/{{.CurTag}}/page/1">回复该文章</a></td>
			<td><a href="/article/{{.CurTag}}">返回文章No.{{.CurTag}}</a></td>
	</tr></table>

	<table id="articles">
	<tr>
	<th class="fit">回复者</th><th></th><th style="text-align: left">回复标题</th>
	<th class="fit last">回复日期</th>
	</tr>
	{{range .Articles}}
	<tr class="darken">
		<td class="fit"><a class="block" href="/user/{{.AuthorID}}">{{.Author}}</a></td>
		<td class="fit">:</td>
		<td class="title">
			<a class="title" href="/article/{{.ID}}">
				{{.Title}}
				{{if .Content}}•{{end}}
			</a><br>
			<span class="time">
			<script type="text/javascript">document.write(etc.date.format({{.ModTimestamp}}));</script>
			</span>
		</td>
		<td class="fit last">
		[<script type="text/javascript">document.write(etc.date.format({{.ModTimestamp}}));</script>]
		</td>
	</tr>
	<tr><td colspan="4"><span class="preview-content">{{.Content}}</span></td>
	</tr>
	{{end}}
	</table>

	<table class="toa"><tr>
			<td><a href="/new/article/{{.CurTag}}?/reply/{{.CurTag}}/page/1">回复该文章</a></td>
			<td><a href="/article/{{.CurTag}}">返回文章No.{{.CurTag}}</a></td>
	</tr></table>
{{else}}
<table id="articles">
	<tr>
		<th class="fit center"></th>
		<th style="text-align: left">文章标题</th>
		<th class="fit">作者</th>
		<th class="fit">回复</th>
		<th class="fit">查看</th>
		<th class="fit last">最后修改</th>
	</tr>
	{{range .Articles}}
	<tr class="darken">

		<td class="fit center">
			<a class="block" href="/tag/{{.Tag}}/page/1">{{.Tag}}</a>
		</td>

		<td class="title">
			<a href="/article/{{.ID}}" class="title">
			{{if .Deleted}}
				<del>{{.Title}}</del>
			{{else}}
				{{.Title}}
			{{end}}
			</a><br>
			<span class="time">
			<script type="text/javascript">document.write(etc.date.format({{.ModTimestamp}}));</script>
			</span>
		</td>
		<td class="fit center"><a href="/user/{{.AuthorID}}">{{.Author}}</a></td>
		<td class="fit center"><a href="/reply/{{.ID}}/page/1"><em>{{.Children}}</em></a></td>
		<td class="fit center"><em>{{.Hits}}</em></td>
		<td class="fit last">
			[<script type="text/javascript">document.write(etc.date.format({{.ModTimestamp}}));</script>]
		</td>
	</tr>
	<tr>
	<td colspan="8"><span class="preview-content">{{.Content}}</span></td>
	</tr>
	{{end}}
</table>
{{end}}

<div class="pager">
	{{if .IsIndexPage}}[ <b>首页</b> ]{{else}}
	[
	<a href="{{.IndexPage}}"> 首页 </a> |
	<a href="{{.Nav.PrevPage}}"> 上一页 </a>
	]
	{{end}}
	{{if .IsLastPage}}
	[ <b>尾页</b> ]
	{{else}}
	[
	<a href="{{.Nav.NextPage}}"> 下一页 </a> |
	<a href="{{.Nav.LastWeekPage}}" >7d</a> |
	<a href="{{.Nav.LastMonthPage}}">30d</a> |
	<a href="{{.Nav.LastYearPage}}" >1y</a> |
	<a href="{{.LastPage}}" >尾页</a>
	]
	{{end}}
</div>